<!-- $Id$ -->
<html>
<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<title>Protocol Modeling with Hierarchical FSM's and the Discrete Event Domain</tile>
</title>
<link href="../../../../../doc/default.css" rel="stylesheet" type="text/css">
</head>
<body>
<h1>Protocol Modeling with Hierarchical FSM's and the Discrete Event Domain</h1>
<p>
<center>
<!-- The HTML below is for the Java Plugin.  The first
     section is for IE, the second is for Netscape
 -->
<OBJECT classid="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93"
 NAME="ABPApplet"
 WIDTH=600 HEIGHT=400
 codebase="http://java.sun.com/products/plugin/1.3/jinstall-13-win32.cab#Version=1,3,0,0">
<PARAM NAME="background" VALUE="#faf0e6">
<PARAM NAME=CODE VALUE="ptolemy.actor.gui.PtolemyApplet.class">
<PARAM NAME="modelClass" VALUE="ptolemy.domains.fsm.demo.ABP.ABP">
<PARAM NAME=CODEBASE VALUE=../../../../..>
<PARAM NAME=ARCHIVE VALUE="
	ptolemy/ptsupport.jar,
	ptolemy/domains/de/de.jar,
	ptolemy/domains/fsm/fsm.jar,
	ptolemy/domains/fsm/demo/ABP/ABP.jar">
<PARAM NAME=NAME VALUE="ABP">
<PARAM NAME="type" VALUE="application/x-java-applet;version=1.3">
<PARAM NAME="controls", value="buttons,topparameters">
<COMMENT>
<EMBED type="application/x-java-applet;version=1.3"
 CODE=ptolemy.actor.gui.PtolemyApplet.class
 CODEBASE=../../../../..
 ARCHIVE="
	ptolemy/ptsupport.jar,
	ptolemy/domains/de/de.jar,
	ptolemy/domains/fsm/fsm.jar,
	ptolemy/domains/fsm/demo/ABP/ABP.jar"
 NAME="ABPApplet"
 WIDTH=600 HEIGHT=400
 background="#faf0e6"
 modelClass="ptolemy.domains.fsm.demo.ABP.ABP"
 controls="buttons,topparameters"
 pluginspage="http://java.sun.com/products/plugin/1.3/plugin-install.html">
<NOEMBED></COMMENT>
<a href="ABP.xml">MoML specification for this model.</a>
</NOEMBED></EMBED>
</OBJECT>
</center>
<p>
This model demonstrates the use of the discrete event (DE) domain
and hierarchical finite state machines (FSM's) to model the alternating
bit protocol (ABP). ABP [2] is a simple mechanism for achieving reliable,
ordered delivery of messages over channels with unreliable delivery and
variable delay. The top level of the model, which operates in the DE domain,
is shown below:
<CENTER>
<P><IMG SRC="img/ABPModel.gif" ></CENTER>
<p>
The components in the model include:
<p>
<B>Message source. </B>
This is a DE atomic actor with a parameter <I>MaxDelay</I>.
After execution starts, it will wait for a random delay uniformly
distributed between <I>0</I> and <I>MaxDelay</I>, and then send a <I>request</I>
to the sender. When it receives a <I>next</I> from the sender, it will
again wait for a random delay uniformly distributed between <I>0</I> and
<I>MaxDelay</I>, and then send a new <I>msgIn</I> with sequence number
increased by one to the sender. In this demo, <I>MaxDelay</I> is set
to <I>0.5</I>.
<P>
<B>Timer. </B>
The timer has an input <I>setTimer</I> of type DoubleToken.
The value of the input token gives the delay before the next timer expire.
The timer is reset every time it gets an input token.
<P><B>Channel. </B>The channel models an unreliable connection in a packet
switching network. It queues the input packets, drops and delays the packets
randomly. A channel has three parameters: <I>DropRate</I>, <I>MinDelay</I>
and <I>MaxDelay</I>. <I>DropRate</I> is the probability that an input packet
gets dropped. Packet delay in the channel is uniformly distributed between
<I>MinDelay</I> and <I>MaxDelay</I>.
<P>
<B>Plot. </B>
The plot shows the result of data transmission. In the
plot, the red data gives the sequence number of the messages coming out
from the receiver. The blue data gives the sequence number of the messages
going to the sender. The third data is the "alternating bit" that the protocol
uses to number the packets going through the channel.
<P><B>Sender. </B>The sender implements the sending part of ABP and is
a hierarchical FSM as shown below:
<CENTER>
<P><IMG SRC="img/Sender.gif" ></CENTER>

<P>
<B>Receiver. </B>
The receiver is a flat FSM as shown below:
<CENTER>
<P><IMG SRC="img/Receiver.gif" ></CENTER>

A sample result of running the demo is shown below.
<CENTER>
<P><IMG SRC="img/Sample.gif" ></CENTER>

The parameter setting is:
<CENTER>
<p>
Forward channel:
<I>DropRate = 0.3; MaxDelay = 5.0; MinDelay = 0.5</I>.
<p>Backward channel:
<I>DropRate = 0.2; MaxDelay = 2.0; MinDelay = 0.2</I>.</CENTER>

<H1>
Discussion</H1>
The purpose of this demo is to show:
<UL>
<LI>
Hierarchical FSM's can efficiently capture complex sequential control behavior.</LI>

<LI>
Embedding FSM's within other models of computation is a clean and flexible
way to model the concurrent execution of FSM's.</LI>
</UL>

<H1>
References</H1>

<OL>
<LI>
A. Girault, B. Lee, and E. A. Lee, ``<A HREF="http://ptolemy.eecs.berkeley.edu/papers/98/starcharts">Hierarchical
Finite State Machines with Multiple Concurrency Models</A>,'' April 13,
1998.</LI>

<LI>
J. Walrand, and P. Varaiya, ``High-Performance Communication Networks,''
pages 69-72, Morgan Kaufmann Publishers, Inc., 1996.</LI>
</OL>

<p><font size="2" color="#cc0000">Last Updated: $Date$</font>
</body>
</html>
