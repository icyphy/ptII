<!-- $Id$ -->
<html>
<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<title>Protocol Modeling with Hierarchical FSMs and the Discrete Event Domain</tile>
</title>
<link href="../../../../../doc/default.css" rel="stylesheet" type="text/css">
</head>
<body>
<h1>Protocol Modeling with Hierarchical FSMs and the Discrete Event Domain</h1>
<p>
<center>
<!-- The HTML below is for the Java Plugin.  The first
     section is for IE, the second is for Netscape
 -->
<!-- HTML CONVERTER -->
<SCRIPT LANGUAGE="JavaScript"><!--
    var _info = navigator.userAgent; 
    var _ns = false; 
    var _ns6 = false;
    var _ie = (_info.indexOf("MSIE") > 0 && _info.indexOf("Win") > 0 && _info.indexOf("Windows 3.1") < 0);
//--></SCRIPT>
    <COMMENT>
        <SCRIPT LANGUAGE="JavaScript1.1"><!--
        var _ns6 = (_info.indexOf("Mozilla/5") >= 0);
        var _ns = (navigator.appName.indexOf("Netscape") >= 0 && ((_info.indexOf("Win") > 0     && _info.indexOf("Win16") < 0 && java.lang.System.getProperty("os.version").indexOf("3.5") < 0) || (_info.indexOf("Sun") > 0) || (_info.indexOf("Linux") > 0) || (_info.indexOf("AIX") > 0) || (_info.indexOf("OS/2") > 0) || (_info.indexOf("IRIX") > 0 )));
//--></SCRIPT>
    </COMMENT>

<SCRIPT LANGUAGE="JavaScript"><!--
    if (_ie == true) document.writeln('\
        <OBJECT \
            classid="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93" \
            width = "600" \
            height = "500"  \
            codebase="http://java.sun.com/products/plugin/autodl/jinstall-1_4_1_02-windows-i586.cab#Version=1,4,1,02"> \
            <PARAM NAME = "code" \
                   VALUE = "ptolemy.actor.gui.MoMLApplet" > \
	    <PARAM NAME = "codebase"   VALUE = "../../../../.." > \
	    <PARAM NAME = "archive" \
                   VALUE = "ptolemy/ptsupport.jar,ptolemy/domains/de/de.jar,ptolemy/domains/fsm/fsm.jar,ptolemy/domains/fsm/demo/ABP/ABP.jar" > \
            <PARAM NAME = "type" \
                   VALUE = "application/x-java-applet;jpi-version=1.4.1_02" > \
            <PARAM NAME = "scriptable" VALUE = "false" > \
            <PARAM NAME = "NAME" VALUE = "MoML" > \
	    <PARAM NAME = "background" VALUE = "#faf0e6" > \
	    <PARAM NAME = "controls" VALUE = "buttons, topParameters" > \
	    <PARAM NAME = "model" VALUE = "ABP.xml" > \
            <a href="ABP.xml">MoML specification for this model.</a> \
        </OBJECT> \
        ');
    else if (_ns == true || _ns6 == true)
         document.writeln('\
        <COMMENT> \
          <EMBED \
            type = "application/x-java-applet;jpi-version=1.4.1_02" \
            code = "ptolemy.actor.gui.MoMLApplet" \
            codebase = "../../../../.." \
            archive = "ptolemy/ptsupport.jar,ptolemy/domains/de/de.jar,ptolemy/domains/fsm/fsm.jar,ptolemy/domains/fsm/demo/ABP/ABP.jar" \
            width = "600" \
            height = "500" \
            NAME = "MoML" background = "#faf0e6" controls = "buttons, topParameters" model = "ABP.xml"  \
            scriptable = "false" \
            pluginspage = "http://java.sun.com/j2se/1.4.1/download.html"> \
              <NOEMBED> \
              <a href="ABP.xml">MoML specification for this model.</a> \
              </NOEMBED> \
           </EMBED> \
        <COMMENT> \
        ');
    else document.writeln('\
        <APPLET \
            code = "ptolemy.actor.gui.MoMLApplet" \
            codebase = "../../../../.." \
            archive = "ptolemy/ptsupport.jar,ptolemy/domains/de/de.jar,ptolemy/domains/fsm/fsm.jar,ptolemy/domains/fsm/demo/ABP/ABP.jar" \
            width = "600" \
            height = "500" \
            > \
            <PARAM NAME = "NAME" VALUE = "MoML" > \
	    <PARAM NAME = "background" VALUE = "#faf0e6" > \
	    <PARAM NAME = "controls" VALUE = "buttons, topParameters" > \
	    <PARAM NAME = "model" VALUE = "ABP.xml" > \
            <a href="ABP.xml">MoML specification for this model.</a> \
        </APPLET> \
        ');
//--></SCRIPT>
<!-- /HTML CONVERTER -->
</CENTER>

<p>
This model demonstrates the use of the discrete event (DE) domain
and hierarchical finite state machines (FSMs) to model the alternating
bit protocol (ABP). ABP [2] is a simple mechanism for achieving reliable,
ordered delivery of messages over channels with unreliable delivery and
variable delay. The top level of the model, which operates in the DE domain,
is shown below:
<CENTER>
<P><IMG SRC="img/ABPModel.gif" ></CENTER>
<p>
The components in the model include:
<p>
<B>Message source. </B>
This is a DE atomic actor with a parameter <I>MaxDelay</I>.
After execution starts, it will wait for a random delay uniformly
distributed between <I>0</I> and <I>MaxDelay</I>, and then send a <I>request</I>
to the sender. When it receives a <I>next</I> from the sender, it will
again wait for a random delay uniformly distributed between <I>0</I> and
<I>MaxDelay</I>, and then send a new <I>msgIn</I> with sequence number
increased by one to the sender. In this demo, <I>MaxDelay</I> is set
to <I>0.5</I>.
<P>
<B>Timer. </B>
The timer has an input <I>setTimer</I> of type DoubleToken.
The value of the input token gives the delay before the next timer expire.
The timer is reset every time it gets an input token.
<P><B>Channel. </B>The channel models an unreliable connection in a packet
switching network. It queues the input packets, drops and delays the packets
randomly. A channel has three parameters: <I>DropRate</I>, <I>MinDelay</I>
and <I>MaxDelay</I>. <I>DropRate</I> is the probability that an input packet
gets dropped. Packet delay in the channel is uniformly distributed between
<I>MinDelay</I> and <I>MaxDelay</I>.
<P>
<B>Plot. </B>
The plot shows the result of data transmission. In the
plot, the red data gives the sequence number of the messages coming out
from the receiver. The blue data gives the sequence number of the messages
going to the sender. The third data is the "alternating bit" that the protocol
uses to number the packets going through the channel.
<P><B>Sender. </B>The sender implements the sending part of ABP and is
a hierarchical FSM as shown below:
<CENTER>
<P><IMG SRC="img/Sender.gif" ></CENTER>

<P>
<B>Receiver. </B>
The receiver is a flat FSM as shown below:
<CENTER>
<P><IMG SRC="img/Receiver.gif" ></CENTER>


<H1>
Discussion</H1>
The purpose of this demo is to show:
<UL>
<LI>
Hierarchical FSM's can efficiently capture complex sequential control behavior.</LI>

<LI>
Embedding FSM's within other models of computation is a clean and flexible
way to model the concurrent execution of FSM's.</LI>
</UL>

<H1>
References</H1>

<OL>
<LI>
A. Girault, B. Lee, and E. A. Lee, ``<A HREF="http://ptolemy.eecs.berkeley.edu/papers/98/starcharts">Hierarchical
Finite State Machines with Multiple Concurrency Models</A>,'' April 13,
1998.</LI>

<LI>
J. Walrand, and P. Varaiya, ``High-Performance Communication Networks,''
pages 69-72, Morgan Kaufmann Publishers, Inc., 1996.</LI>
</OL>

<p><font size="2" color="#cc0000">Last Updated: $Date$</font>
</body>
</html>
