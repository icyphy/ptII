<!-- : $Id$
  @author: 
 -->
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<link href="../../../../../doc/default.css" rel="stylesheet" type="text/css">
<TITLE>StaticUnits</TITLE>
</HEAD>
<BODY>
<H1>StaticUnits</H1>
<P>
The Static Units System in Ptolemy II provides the means to constrain
a model in terms of the allowable units of measure for the actors, and
ports on the actors.  It is static, in that the constraints do not
relevant when the model is run.  Rather, the constraints are used to
determine if the model is correct.
</p>
<p>
In order to illustrate these concepts, the Fermenter model, shown here, will be used.
</p>

<CENTER>
<P>
<!-- The HTML below is for the Java Plugin.  The first
     section is for IE, the second is for Netscape 4, the third for Mozilla 1.0
     For information about applets and Ptolemy, see
	http://ptolemy.eecs.berkeley.edu/ptolemyII/ptIIlatest/ptII/doc/coding/applets.htm
     For information about java versions and applet tags, see:
	http://java.sun.com/products/plugin/versions.html
     We are currently using 1.4.2 because:
        There is a bug under JDK1.4.1 XP with Radeon display cards
        that causes XP to hang when exiting.  For details, see
        http://developer.java.sun.com/developer/bugParade/bugs/4713003.html
 -->
<!-- HTML CONVERTER -->
<SCRIPT LANGUAGE="JavaScript"><!--
    var _info = navigator.userAgent; 
    var _ns = false; 
    var _ns6 = false;
    var _ie = (_info.indexOf("MSIE") > 0 && _info.indexOf("Win") > 0 && _info.indexOf("Windows 3.1") < 0);
//--></SCRIPT>
    <COMMENT>
        <SCRIPT LANGUAGE="JavaScript1.1"><!--
        var _ns6 = (_info.indexOf("Mozilla/5") >= 0);
        var _ns = (navigator.appName.indexOf("Netscape") >= 0 && ((_info.indexOf("Win") > 0     && _info.indexOf("Win16") < 0 && java.lang.System.getProperty("os.version").indexOf("3.5") < 0) || (_info.indexOf("Sun") > 0) || (_info.indexOf("Linux") > 0) || (_info.indexOf("AIX") > 0) || (_info.indexOf("OS/2") > 0) || (_info.indexOf("IRIX") > 0 )));
//--></SCRIPT>
    </COMMENT>

<SCRIPT LANGUAGE="JavaScript"><!--
    if (_ie == true) document.writeln('\
        <OBJECT \
            classid="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93" \
            width = "733" \
            height = "1506"  \
            codebase="http://java.sun.com/products/plugin/autodl/jinstall-1_4_2-windows-i586.cab#Version=1,4,2"> \
            <PARAM NAME = "code" \
                   VALUE = "ptolemy.vergil.MoMLViewerApplet" > \
	    <PARAM NAME = "codebase"   VALUE = "../../../../.." > \
	    <PARAM NAME = "archive" \
                   VALUE = "ptolemy/domains/ct/ct.jar,ptolemy/ptsupport.jar,lib/diva.jar,ptolemy/domains/fsm/fsm.jar,ptolemy/vergil/vergilApplet.jar" > \
            <PARAM NAME = "type" \
                   VALUE = "application/x-java-applet;version=1.4.2" > \
            <PARAM NAME = "progressbar" VALUE = "true"> \
            <PARAM NAME = "scriptable" VALUE = "false" > \
            <PARAM NAME = "NAME" VALUE = "StaticUnitsViewer" > \
	    <PARAM NAME = "background" VALUE = "#faf0e6" > \
	    <PARAM NAME = "modelURL" VALUE = "StaticUnits.xml" > \
	    <PARAM NAME = "controls" VALUE = "buttons" > \
	    <PARAM NAME = "includeRunPanel" VALUE = "true" > \
            <a href="StaticUnits.xml">MoML specification for this model.</a> \
        </OBJECT> \
        ');
    else if (_ns == true || _ns6 == true)
         document.writeln('\
        <COMMENT> \
          <EMBED \
            type = "application/x-java-applet;version=1.4.2" \
            code = "ptolemy.vergil.MoMLViewerApplet" \
            codebase = "../../../../.." \
            archive = "ptolemy/domains/ct/ct.jar,ptolemy/ptsupport.jar,lib/diva.jar,ptolemy/domains/fsm/fsm.jar,ptolemy/vergil/vergilApplet.jar" \
            width = "733" \
            height = "1506" \
            NAME = "StaticUnitsViewer" background = "#faf0e6" modelURL = "StaticUnits.xml" controls = "buttons" includeRunPanel = "true"  \
            progressbar = "true" \
            scriptable = "false" \
            pluginspage = "http://java.sun.com/j2se/1.4.2/download.html"> \
              <NOEMBED> \
              <a href="StaticUnits.xml">MoML specification for this model.</a> \
              </NOEMBED> \
           </EMBED> \
        <COMMENT> \
        ');
    else document.writeln('\
        <APPLET \
            code = "ptolemy.vergil.MoMLViewerApplet" \
            codebase = "../../../../.." \
            archive = "ptolemy/domains/ct/ct.jar,ptolemy/ptsupport.jar,lib/diva.jar,ptolemy/domains/fsm/fsm.jar,ptolemy/vergil/vergilApplet.jar" \
            width = "733" \
            height = "1506" \
            > \
            <PARAM NAME = "NAME" VALUE = "StaticUnitsViewer" > \
	    <PARAM NAME = "background" VALUE = "#faf0e6" > \
	    <PARAM NAME = "modelURL" VALUE = "StaticUnits.xml" > \
	    <PARAM NAME = "controls" VALUE = "buttons" > \
	    <PARAM NAME = "includeRunPanel" VALUE = "true" > \
            <a href="StaticUnits.xml">MoML specification for this model.</a> \
        </APPLET> \
        ');
//--></SCRIPT>
<!-- /HTML CONVERTER -->
</CENTER>
</p>
<p>
The purpose of this model is simulate the growth process in a fermenter.
There are three
submodels; 1) growth models the number of cells being produced as a
function of the current number of cells and the vat temperature,
2) HeatProduction models the amount of heat produced (in calories) as
a function of the amount of work done (in joules), and 3) HeatExchanger
models the removal of heat from the vat as a function of the rate at
which water flows through the cooling jacket around the vat.
</p>

<h2>Port Units Specifications</h2>
In order to see the units specifications on the ports of the actors
the PortConfigurerDialog must be used.  
<br><b>Note:</b>Currently, applets do not support the PortConfigurer dialog. 
<br>Right mouse click on the actor and select "Configure Ports".
For example, applying the PortConfigurerDialog to the HeatExcnager actor shows
<p>
<center>
<img src="StaticUnits2.gif" alt="port configuration for Heat Exchanger">
</center>
</p>
<p>
Note the units column which shows that,
the TempVessel port has units <b>degree</b>,
the TempCW port has units <b>degree</b>,
the output port has units <b>calories/second</b>,
and, the flow port has units <b>gallons/hour</b>.
</p>
<h2>Actor Units Specifications</h2>

In order to see the units sepcifications on the actors the
ConfigureUnitsDialog must be used.
<br><b>Note:</b>Currently, applets do not support the ConfigureUnitsDialog.
<br>Right mouse click on the actor and
select "Configure Units".  For example, applying the
ConfigurerUnitsDialog to the AddSubtract actor shows

<p>
<center>
<img src="StaticUnits3.gif" alt="unit constraints for AddSubtract">
</center>
</p>
<p>

This shows that there are two units constraints for the AddSubtract
actor.  The expression <b>$plus=$minus</b> says that the plus and
minus ports must have the same units. That is, it is incorrect to
subtract <b>gallons/hour</b> from <b>gallons</b>.  Similarly, the
expression <b>$output=$minus</b> says that the output port must have
the same units as the minus port.

</p>
<p>
Some of the units constraints in the model are inconsistent.  In
addition to the HeatExchanger port unitconstraints, and AddSubtract
actor unit constraints illustrated above, the HeatProduction.heat port
has the units <b>calories</b>.  Since the HeatProduction.heat port is
connected (via the AddSubtract actor) to the HeatExchanger.output port
which has units <b>calories/second</b> the model is inconsistent in
terms of the units constraints.
<p>
The UnitsConstraint Solver can be used to discover, and
analyse these inconsistencies. (Right mouse-click and select
UnitsConstraint Solver).
</p>
</BODY>
</HTML>
