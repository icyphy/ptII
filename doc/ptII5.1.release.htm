<!-- $Id$ -->
<html>
<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<title>Ptolemy II 5.1-alpha Release Notes</title>
<link href="default.css" rel="stylesheet" type="text/css">
</head>
<body bgcolor="#faf0e6">
<h1>Ptolemy II 5.1-alpha Release Notes</h1>

Ptolemy II is a set of Java packages supporting heterogeneous,
concurrent modeling and design.  Its <code>kernel</code> package
supports clustered hierarchical graphs, which are collections of
<I>entities</I> and <I>relations</I> between those entities.  Its
<code>actor</code> package extends the kernel so that entities have
functionality and can communicate via the relations.  Its
<I>domains</I> extend the actor package by imposing <I>models of
computation</I> on the interaction between entities.  Examples of
models of computation include discrete-event systems, dataflow,
process networks, synchronous/reactive systems, and communicating
sequential processes.

 <p>Ptolemy II includes a number of support packages, such as 

 <br><code>data</code>, providing a type system, data encapsulation and an
 expression parser,

 <br><code>plot</code>, providing visual display of data,

 <br><code>math</code>, providing matrix and vector math and signal
processing functions, and

 <br><code>graph</code>, providing graph-theoretic manipulations.


 <p>The three volumes of the Ptolemy II Design Document
describes the Ptolemy II design and
the implementation of the Java classes.
<ul>
 <li><a href="design/ptIIdesign1-intro.pdf">Volume 1: Introduction to Ptolemy II</a> (Local PDF)
 <li><a href="design/ptIIdesign2-software.pdf">Volume 2: Ptolemy II Software Architecture</a> (Local PDF)
 <li><a href="design/ptIIdesign3-domains.pdf">Volume 3: Ptolemy II Domains</a> (Local PDF)
</ul>

 <p>The
"<a href="design/usingVergil/index.htm">Using Vergil</a>"
describes how to use Vergil.


<h2>Complete List of Domains in Ptolemy II</h2>
 <!-- We include this list here since we will be posting the release notes
to the newsgroups etc.  See also main.htm
 -->
<ul>
<li> <a href="../ptolemy/domains/ci/doc/body.htm" target="body">CI</a>:
	 component interaction (experimental),
<li> <a href="../ptolemy/domains/csp/doc/body.htm" target="body">CSP</a>:
	 communicating sequential processes,
<li> <a href="../ptolemy/domains/ct/doc/body.htm" target="body">CT</a>:
	continuous-time modeling,
<li> <a href="../ptolemy/domains/de/doc/body.htm" target="body">DE</a>:
	discrete-event modeling,
<li> <a href="../ptolemy/domains/dde/doc/body.htm" target="body">DDE</a>:
	distributed discrete events (experimental),
<li> <a href="../ptolemy/domains/ddf/doc/body.htm" target="body">DDF</a>:
	dynamic dataflow
<li> <a href="../ptolemy/domains/dt/doc/body.htm" target="body">DT</a>:
	discrete time,
<li> <a href="../ptolemy/domains/fsm/doc/body.htm" target="body">FSM</a>:
	finite state machines,
<li> <a href="../ptolemy/domains/giotto/doc/body.htm" target="body">Giotto</a>:
	periodic time-driven (experimental),
<li> <a href="../ptolemy/domains/gr/doc/body.htm" target="body">GR</a>:
	3-D graphics (experimental),
 <!-- petrinet ??-->
<li> <a href="../ptolemy/domains/hdf/doc/body.htm" target="body">HDF</a>:
	heterochronous dataflow
<li> <a href="../ptolemy/domains/pn/doc/body.htm" target="body">PN</a>:
	process networks,
<li> <a href="../ptolemy/domains/psdf/doc/body.htm" target="body">PSDF</a>:
	parameterized synchronous dataflow (experimental),
<li> <a href="../ptolemy/domains/sdf/doc/body.htm" target="body">SDF</a>:
	synchronous dataflow,
<li> <a href="../ptolemy/domains/sr/doc/body.htm" target="body">SR</a>:
	synchronous/reactive,
<li> <a href="../ptolemy/domains/tm/doc/body.htm" target="body">TM</a>:
	timed multitasking (experimental), and
<li> <a href="../ptolemy/domains/wireless/doc/body.htm" target="body">Wireless</a>:
	 wireless (experimental).

</ul>

<h2>Platforms</h2>

The core of Ptolemy II 5.0 is 100% Java, so it should work on any
platform that has JDK 1.4 or later.

 <p>We developed Ptolemy II 5.0 under Solaris 8 and Windows XP sp2
and with JDK1.4.2_08.

<p>Ptolemy II 5.0 will not compile under Java 1.3 because we use the
java.lang.URI class, which is present only in Java 1.4 and later.

<p>There are various problems with Sun Java 1.5.0:
<menu>
<li> <a href="#webstart1.5.0-beta">Web Start</a> does not work
<li> Caltrop does not work because of XML parser issues
</menu>

 <p>Ptolemy II has been compiled and run
under IBM JDK 1.4.2_01-b06.  There are the following limitations
under IBM JDK 1.4.2:
<menu>
<li> The Copernicus code generator does not work.
<li> Caltrop does not work.
<li> The IBM JDK seems to return directory contents in a different
order than the Sun JDK.  Thus actor.lib.io.DirectoryListing
might return elements in a different order.
</menu>




<!--whatsnew-->
Contents:
<ul>
<li> <a href="#highlights">Highlights</a>
<li> <a href="#other">Other Key New Capabilities</a>
<li> <a href="#libraries">New and Enhanced Actor Libraries</a>
<li> <a href="#demos">New demonstrations</a>
<li> <a href="#features">Additional features</a>
<li> <a href="#bugs">Bug fixes</a>
</ul>

<h2> <a name="highlights">Highlights</a>
</h2>

<h3>Ptolemy II 5.1 Highlights</h3>

<menu>
<li> <a href="../configs/viptos/index.htm">Viptos</a> - an interface
between TinyOS and Ptolemy II

<li> Distributed Ptolemy
</menu>

<h3>Ptolemy II 5.0 Highlights</h3>


<ul>
<li> <i>Dynamic Dataflow</i>:
<a href="../ptolemy/domains/ddf/demo/HanoiTower/HanoiTower.htm">HanoiTower</a>
(see also
<a href="../ptolemy/domains/ddf/demo/Eratosthenes/Eratosthenes.htm">Eratosthenes</a>,
<a href="../ptolemy/domains/ddf/demo/IfThenElse/IfThenElse.htm">IfThenElse</a>,
<a href="../ptolemy/domains/ddf/demo/Loop/Loop.htm">Loop</a>,
<a href="../ptolemy/domains/ddf/demo/OrderedMerge/OrderedMerge.htm">OrderedMerge</a>,
<a href="../ptolemy/domains/ddf/demo/RandomWalk/RandomWalk.htm">RandomWalk</a>)
<br>
In dynamic dataflow (DDF) models, actors are fired in response to available
input data. The schedule is dynamic and data dependent, and actors can
change their production and consumption rates in each firing.
Unlike synchronous dataflow, the DDF model of computation is Turing
complete, and questions of deadlock and boundedness are undecidable.
The <a href="../ptolemy/domains/ddf/demo/HanoiTower/HanoiTower.htm">HanoiTower</a>
example exploits this to give an algorithmic solution to the well-known
towers of Hanoi problem.

<br>
<li>
<i>Modeling of hybrid systems</i>:
<a href="../ptolemy/domains/ct/demo/NewtonsCradle/NewtonsCradleComplicated.htm">NewtonsCradleComplicated</a>.
<br>
<i>Hybrid systems</i> are a special case of modal models
where finite-state machines (FSMs) are combined with the continuous-time (CT) models
to get mixed continuous-time and discrete-event models.
The HyVisual package
is a subset of Ptolemy II that includes the FSM and CT domains and libraries
that support the design of hybrid systems.
Version 5.0 introduces significant rework of the hybrid systems
modeling infrastructure to have more complete and predictable
semantics, as described in the paper
"<a href="http://ptolemy.eecs.berkeley.edu/publications/papers/05/OperationalSemantics/#in_browser">
Operational Semantics of Hybrid Systems</a>".
The
<a href="../ptolemy/domains/ct/demo/NewtonsCradle/NewtonsCradleComplicated.htm">NewtonsCradleComplicated</a>
example illustrates this with a model of a physical system that has simultaneous
events.

<br>
<li><i>Stochastic hybrid systems</i>:
<a href="../ptolemy/domains/ct/demo/Spontaneous/IncreasingRatePoisson.htm">IncreasingRatePoisson</a>
(see also
<a href="../ptolemy/domains/ct/demo/Hysteresis/HysteresisWithRandomDelay.htm">HysteresisWithRandomDelay</a>,
<a href="../ptolemy/domains/ct/demo/Brownian/Brownian.htm">Brownian</a>
).
<br>
Stochastic hybrid systems add random behavior to continuous-time models mixed
with discrete events. The 
<a href="../ptolemy/domains/ct/demo/Spontaneous/IncreasingRatePoisson.htm">IncreasingRatePoisson</a>
models spontaneous mode transitions governed by a Poisson process.
The <a href="../ptolemy/domains/ct/demo/Hysteresis/HysteresisWithRandomDelay.htm">HysteresisWithRandomDelay</a>
example uses similar spontaneous mode transitions to model random delay in mode transitions.
The <a href="../ptolemy/domains/ct/demo/Brownian/Brownian.htm">Brownian</a> example
models a stochastic differential equation describing a random walk process.

<br>
<li> <i>Heterochronous Dataflow</i>:
<a href="../ptolemy/domains/hdf/demo/Fibonacci/Fibonacci.htm">Fibonacci</a>
(see also
<a href="../ptolemy/domains/hdf/demo/Merge/Merge.htm">Merge</a>).
<br>
Heterochronous dataflow (HDF) is an extension of synchronous dataflow
(SDF) that permits dynamically changing production and consumption
patterns without sacrificing static scheduling. In SDF, the production
and consumption patterns of an actor are constant.
In HDF they are allowed to change between iterations of the HDF schedule.
Modal models can be used to change these patterns.
Although HDF can express many data-dependent computations that cannot
be represented by SDF, it is not Turing complete.  Consequently, deadlock
and boundedness remain decidable.
The <a href="../ptolemy/domains/hdf/demo/Fibonacci/Fibonacci.htm">Fibonacci</a>
example uses this mechanism in a clever way to extract a Fibonacci sequence
from a counting sequence.

</ul>

<h2><a name="other">Other Key New Capabilities</a>
</h2>
<ul>

<li><i>Unbounded model time</i>: LongRuns
<br>
Version 5.0 introduces a new
<a href="../ptolemy/../doc/codeDoc/ptolemy/actor/util/Time.html">Time</a> class
that represents model time in a manner that has a specified resolution
and unbounded growth potential. Any two time values that are within the specified
resolution are treated as equal. Moreover, time can increase forever without
concern for loss of resolution or overflow.
The LongRuns
example is a discrete-event model that can be run forever, in principle,
without (significant) growth of memory requirements and without loss
of (internal) precision in model time.
The precision of time representations is given by a director parameter
whose value is shared across all directors in a model (see
<a href="../ptolemy/../doc/codeDoc/ptolemy/moml/SharedParameter.html">SharedParameter</a>).
<br>

<li><i>Synchronous Reactive Modeling</i>:
<a href="../ptolemy/domains/sr/demo/GuardedCount/GuardedCount.htm">GuardedCount</a>.
<br>
The synchronous/reactive (SR) domain,
which is inspired by the synchronous languages Esterel, Lustre, and Signal,
realizes a concurrency model where actors react instantaneously and simultaneously
at ticks of a logical clock. Version 5.0 introduces a richer set of actors
for use with this domain, as well as a bug fix permitting
SROptimizedScheduler to be used inside a composite actor.
The <a href="../ptolemy/domains/sr/demo/GuardedCount/GuardedCount.htm">GuardedCount</a>
example illustrates some of these new capabilities.
The new actors are:
<ul>
 <li> <a href="../ptolemy/../doc/codeDoc/ptolemy/domains/sr/lib/Current.html">Current</a>
 <li> <a href="../ptolemy/../doc/codeDoc/ptolemy/domains/sr/lib/Default.html">Default</a>
 <li> <a href="../ptolemy/../doc/codeDoc/ptolemy/domains/sr/lib/EnabledComposite.html">EnabledComposite</a>
 <li> <a href="../ptolemy/../doc/codeDoc/ptolemy/domains/sr/lib/Pre.html">Pre</a>
 <li> <a href="../ptolemy/../doc/codeDoc/ptolemy/domains/sr/lib/When.html">When</a>
</ul>

<li><i>Nondeterministic merge in Process Networks (PN)</i>:
<a href="../ptolemy/domains/pn/demo/NondeterministicMerge/NondeterministicMerge.htm">NondeterministicMerge</a>.
<br>
The PN domain now supports a NondeterministicMerge actor, which merges two
incoming streams nondeterministically. This new actor should be used with
caution, since determinism is one of the key features of PN. Use of this
actor is risky because any given execution is only representative of
the possible executions. Nonetheless, this offers a considerable
increment in expressiveness.

<br>

<li><i>New Parameters</i>:
<br>
A number of new parameters have been introduced.
The <a href="../ptolemy/../doc/codeDoc/ptolemy/actor/parameters/DoubleRangeParameter.html">DoubleRangeParameter</a>
limits the range and precision of a double-valued parameter,
and is supported in the user interface by providing a slider by default in parameter
editing dialogs.
The <a href="../ptolemy/../doc/codeDoc/ptolemy/actor/parameters/FilePortParameter.html">FilePortParameter</a>
is used by actors to specify a file or URL using both a
parameter and a port. The user interface supports this by offering a file browser
dialog by default when editing this parameter. The
<a href="../ptolemy/../doc/codeDoc/ptolemy/moml/SharedParameter.html">SharedParameter</a>
is a parameter
whose value is constrained to be identical to a suite of other instances of
SharedParameter in the same model. This parameter is used, for example, to
handle seeds in random number generators, as illustrated for example in
ColtRandom.

<br>
<li><i>Higher Order Components</i>:
ExecDemos
(see also
<a href="../ptolemy/actor/lib/hoc/demo/IterateOverArray/IterateOverArray.htm">IterateOverArray</a>).
<br>
The higher-order component capabilities of Ptolemy II continue to evolve.
The ExecDemos model, when executed, starts a new
Java virtual machine that then executes the
RunDemos model,
which runs all demos in a specified directory using full-screen mode.
This illustrates how to use higher-order actors to control the lifecylcle of other Ptolemy II
models. This example can be set up to automatically and repeatedly run demos
unattended by following the instructions in the
<a href="../ptolemy/demo/README.txt">README.txt</a> file.
The new higher-order actors include:
<ul>
 <li> <a href="../ptolemy/../doc/codeDoc/ptolemy/actor/lib/hoc/ApplyFilterOverArray.html">ApplyFilterOverArray</a>
 <li> <a href="../ptolemy/../doc/codeDoc/ptolemy/actor/lib/hoc/ApplyFunction.html">ApplyFunction</a>
 <li> <a href="../ptolemy/../doc/codeDoc/ptolemy/actor/lib/hoc/ApplyFunctionOverSequence.html">ApplyFunctionOverSequence</a>
 <li> <a href="../ptolemy/../doc/codeDoc/ptolemy/actor/lib/hoc/IterateOverArray.html">IterateOverArray</a>
</ul>

<li> <i>Graphics domain</i>:
<a href="../ptolemy/domains/gr/demo/SolarSystem/SolarSystem.htm">SolarSystem</a>
(see also <a href="../ptolemy/domains/gr/demo/Helen/Helen.htm">Helen</a>).
<br>
The graphics (GR) domain has been extensively revised to take better advantage of underlying
capabilities in the Java 3D package. For example, the
<a href="../ptolemy/domains/gr/demo/SolarSystem/SolarSystem.htm">SolarSystem</a>
model illustrates transparency (see the rings of Saturn), and the
<a href="../ptolemy/domains/gr/demo/Helen/Helen.htm">Helen</a> model
illustrates texture mapping and movable viewer positioning.
The following capabilities are now supported:
<ul>
 <li>transparency
 <li>texture mapping
 <li>shininess
 <li>colors use ColorAttribute
 <li>more colors can be set
 <li>settable resolution
 <li>wireframe option for shapes
 <li>flat facets option for shapes
 <li>run-time changes of parameter values
 <li>parameters in the Text3D actor
 <li>movable viewer position
</ul>

</ul>

<h2><a name="libraries">New and Enhanced Actor Libraries</a>
</h2>
A number of new and enhanced actor libraries are included in version 5.0.
You may also wish to refer to the
<a href="../ptolemy/../doc/codeDoc/ptolemy/actor/lib/package-summary.html">ptolemy.actor.lib</a>
package, where most of the domain-polymorphic actors reside (domain-polymorphic actors are
those that can be used in more than one domain).

<ul>
<li><i>New generic actors</i>:
<ul>
<li> <a href="../ptolemy/../doc/codeDoc/ptolemy/actor/lib/Sequence.html">Sequence</a>
</ul>

<li><i>Random number generators</i>:
ColtRandom.
<br>
A new library of random number generators, developed jointly with
David Bauer and Kostas Oikonomou from AT&amp;T Research, is based on the popular
Colt "Open Source Libraries for High
Performance Scientific and Technical
Computing in Java."
Colt is described at
<a href="http://hoschek.home.cern.ch/hoschek/colt/#in_browser" target="_top">
<CODE>http://hoschek.home.cern.ch/hoschek/colt/</CODE></a>.
The library supports many
commonly used probability distributions and provides
systematic management of seeds and random number generation
techniques.

<br>
<li><i>New discrete-event actors</i>:
<ul>
<li> <a href="../ptolemy/../doc/codeDoc/ptolemy/domains/de/lib/NonInterruptibleTimer.html">NonInterruptibleTimer</a>
<li> <a href="../ptolemy/../doc/codeDoc/ptolemy/domains/de/lib/Register.html">Register</a>
</ul>

<li> <i>Communications library</i>:
<br>
The <a href="../ptolemy/../doc/codeDoc/ptolemy/actor/lib/comm/package-summary.html">communications library</a>
includes a number of new actors:
<ul>
 <li> <a href="../ptolemy/../doc/codeDoc/ptolemy/actor/lib/comm/HuffmanBasic.html">HuffmanBasic</a>
 <li> <a href="../ptolemy/../doc/codeDoc/ptolemy/actor/lib/comm/HuffmanCoder.html">HuffmanCoder</a>
 <li> <a href="../ptolemy/../doc/codeDoc/ptolemy/actor/lib/comm/HuffmanDecoder.html">HuffmanDecoder</a>
 <li> <a href="../ptolemy/../doc/codeDoc/ptolemy/actor/lib/comm/LempelZivCoder.html">LempelZivCoder</a>
 <li> <a href="../ptolemy/../doc/codeDoc/ptolemy/actor/lib/comm/LempelZivDecoder.html">LempelZivDecoder</a>
</ul>

</ul>

<h2> <a name="demos">New Demonstrations</a>
</h2>
<ul>
<li>New Continuous Time demos:
<ul>
<li> <a href="../ptolemy/domains/ct/demo/Brownian/Brownian.htm">Brownian</a> 
<li> <a href="../ptolemy/domains/ct/demo/ContinuousClock/ContinuousClock.htm">Continuous Clock</a>
<li> <a href="../ptolemy/domains/ct/demo/HierarchicalExecution/HierarchicalExecution.htm">Hierarchical Execution</a>
<li> <a href="../ptolemy/domains/ct/demo/Hysteresis/Hysteresis.htm">Hysteresis</a>
<li> <a href="../ptolemy/domains/ct/demo/Hysteresis/HysteresisWithRandomDelay.htm">HysteresisWithRandomDelay</a>
<li> <a href="../ptolemy/domains/ct/demo/Hysteresis/HysteresisWithRandomLosses.htm">HysteresisWithRandomLosses</a>
<li> <a href="../ptolemy/domains/ct/demo/Spontaneous/IncreasingRatePoisson.htm">IncreasingRatePoisson</a>
<li> <a href="../ptolemy/domains/ct/demo/LevelCrossingDetectorDetectsGlitches/LevelCrossingDetectorDetectsGlitches.htm">Level Crossing Detector Detects Glitches</a>
<li> <a href="../ptolemy/domains/ct/demo/LevelCrossingDetector/LevelCrossingDetectorDetectingDirections.htm">Level Crossing Detector with Different Detecting Directions</a>
<li> <a href="../ptolemy/domains/ct/demo/NewtonsCradle/NewtonsCradle.htm">Newton's Cradle</a>
<li> <a href="../ptolemy/domains/ct/demo/NewtonsCradle/NewtonsCradleComplicated.htm">Newton's Cradle with Complicated Dynamics</a>
<li> <a href="../ptolemy/domains/ct/demo/NewtonsCradle/NewtonsCradleNondeterministic.htm">Newton's Cradle with Nondeterministic State Macine</a>
<li> <a href="../ptolemy/domains/ct/demo/Spontaneous/Poisson.htm">Poisson</a>
<li> <a href="../ptolemy/domains/ct/demo/SampledClocks/SampledClocks.htm">Sampled Clocks</a>
<li> <a href="../ptolemy/domains/ct/demo/Satellite/Satellite.htm">Satellite</a>
<li> <a href="../ptolemy/domains/ct/demo/StickyMasses/StickyMassesNewVersion.htm">Sticky Point Masses Modified Version</a>
<li> <a href="../ptolemy/domains/ct/demo/ContinuousClock/TriggeredContinuousClock.htm">Triggered Continuous Clock</a>
<li> <a href="../ptolemy/domains/ct/demo/V2V/V2V.htm">Vehicle 2 Vehicle</a>
</ul>

<li>New Discrete Event (DE) demos:
<ul>
 <li><a href="../ptolemy/domains/de/demo/AssemblyLine/AssemblyLine.htm">Assembly Line</a> 
 <li><a href="../ptolemy/domains/de/demo/HierarchicalModel/HierarchicalModel.htm">Hierarchical Model</a> 
</ul>

<li> New Dynamic Dataflow (DDF) demos:
<ul>
 <li><a href="../ptolemy/domains/ddf/demo/Eratosthenes/Eratosthenes.htm">Eratosthenes</a>
 <li><a href="../ptolemy/domains/ddf/demo/Factorial/Factorial.htm">Factorial</a>
 <li><a href="../ptolemy/domains/ddf/demo/HanoiTower/HanoiTower.htm">HanoiTower</a>
 <li><a href="../ptolemy/domains/ddf/demo/IfThenElse/IfThenElse.htm">IfThenElse</a>
 <li><a href="../ptolemy/domains/ddf/demo/Loop/Loop.htm">Loop</a>
 <li><a href="../ptolemy/domains/ddf/demo/OrderedMerge/OrderedMerge.htm">OrderedMerge</a>
 <li><a href="../ptolemy/domains/ddf/demo/RandomWalk/RandomWalk.htm">RandomWalk</a>
 <li><a href="../ptolemy/domains/ddf/demo/RijndaelEncryption/RijndaelEncryption.htm">RijndaelEncryption</a>
</ul>

<li> New Heterochronous Dataflow (HDF) demos:
<ul>
 <li><a href="../ptolemy/domains/hdf/demo/AdaptiveCoding/AdaptiveCoding.htm">AdaptiveCoding</a>
 <li><a href="../ptolemy/domains/hdf/demo/Fibonacci/Fibonacci.htm">Fibonacci</a>
 <li><a href="../ptolemy/domains/hdf/demo/Hysteresis/Hysteresis.htm">Hysteresis</a>
 <li><a href="../ptolemy/domains/hdf/demo/Merge/Merge.htm">Merge</a>
</ul>

<li>New Giotto demos:
<ul>
<li><a href="../ptolemy/domains/giotto/demo/Multimode/Multimode.htm">Multimode</a>
</ul>

<li> New Graphics (GR) demos
(requires Java 3D, see the <a href="../ptolemy/domains/gr/doc/main.htm">GR domain</a>):
<ul>
<li> <a href="../ptolemy/domains/gr/demo/Helen/Helen.htm">Helen</a>
<li> <a href="../ptolemy/domains/gr/demo/SolarSystem/SolarSystem.htm">SolarSystem</a>
</ul>

<li> New Wireless demos:
<ul>
<li> <a href="../ptolemy/domains/wireless/demo/SmartParking/SmartParking.htm">SmartParking</a>
</ul>

</ul>

<h2>
<a name="features"> Additional Features </a>
</h2>
<ul>

<li> <i>Java compatibility</i>:
<br>
Ptolemy II can be compiled under Java 1.5.0_01.  Java 1.4.2_07
is preferred though.

<br>

<li>Support changing the order of attributes, ports, etc., and
support moving objects towards the foreground or background
in the user interface. This is particularly helpful when
editing icons, since the elements of the icon can now be sent
to the background or brought to the foreground by right clicking
and selecting the appropriate option.

<br>

<li> <i>Fractional math</i>:
<br>
A new library supporting arithmetic on fractions has been created. See:
<ul>
 <li> <a href="codeDoc/ptolemy/math/FractionArrayMath.html">FractionArrayMath</a>
 <li> <a href="codeDoc/ptolemy/math/FractionMatrixMath.html">FractionMatrixMath</a>
</ul>

<li>Added external source (URL) option to the Instantiate Entity
command in the Graph menu.

<li> Other New java files:
  <ul>
    <li> <a href="codeDoc/ptolemy/actor/StateReceiver.html">ptolemy/StateReceiver.java</a>
    <li> <a href="codeDoc/ptolemy/actor/TypeOpaqueCompositeActor.html">ptolemy/actor/TypeOpaqueCompositeActor.java</a>
    <li> <a href="codeDoc/ptolemy/actor/gui/CompositeActorSimpleApplication.html">ptolemy/actor/gui/CompositeActorSimpleApplication.java</a>
    <li> <a href="codeDoc/ptolemy/actor/gui/PasswordAttribute.html">ptolemy/actor/gui/PasswordAttribute.java</a>
    <li> <a href="codeDoc/ptolemy/actor/gui/QueryUtilities.html">ptolemy/actor/gui/QueryUtilities.java</a>
    <li> <a href="codeDoc/ptolemy/actor/lib/StringConst.html">ptolemy/actor/lib/StringConst.java</a>
    <li> <a href="codeDoc/ptolemy/actor/lib/UnaryMathFunction.html">ptolemy/actor/lib/UnaryMathFunction.java</a>
    <li> <a href="codeDoc/ptolemy/actor/lib/image/ImageTableau.html">ptolemy/actor/lib/image/ImageTableau.java</a>
    <li> <a href="codeDoc/ptolemy/actor/util/DFUtilities.html">ptolemy/actor/util/DFUtilities.java</a>
    <li> <a href="codeDoc/ptolemy/caltrop/actors/AbstractCalInterpreter.html">ptolemy/caltrop/actors/AbstractCalInterpreter.java</a>
    <li> <a href="codeDoc/ptolemy/domains/ct/kernel/solver/ExplicitRK45Solver.html">ptolemy/domains/ct/kernel/solver/ExplicitRK45Solver.java</a>
    <li> <a href="codeDoc/ptolemy/domains/fsm/kernel/NonStrictFSMDirector.html">ptolemy/domains/fsm/kernel/NonStrictFSMDirector.java</a>
    <li> <a href="codeDoc/ptolemy/kernel/util/Moveable.html">ptolemy/kernel/util/Moveable.java</a>
    <li> <a href="codeDoc/ptolemy/moml/filter/GRColorChanges.html">ptolemy/moml/filter/GRColorChanges.java</a>
    <li> <a href="codeDoc/ptolemy/vergil/kernel/attributes/AbstractTextAttribute.html">ptolemy/vergil/kernel/attributes/AbstractTextAttribute.java</a>
    <li> <a href="codeDoc/ptolemy/vergil/kernel/attributes/AttributeExpressionAttribute.html">ptolemy/vergil/kernel/attributes/AttributeExpressionAttribute.java</a>
    <li> <a href="codeDoc/ptolemy/vergil/kernel/attributes/AttributeValueAttribute.html">ptolemy/vergil/kernel/attributes/AttributeValueAttribute.java</a>
    <li> <a href="codeDoc/ptolemy/vergil/kernel/attributes/IDAttribute.html">ptolemy/vergil/kernel/attributes/IDAttribute.java</a>
    <li> <a href="codeDoc/ptolemy/vergil/toolbox/MoveAction.html">ptolemy/vergil/toolbox/MoveAction.java</a>
  </ul>

</ul>


<h2>
<a name="bugs"> Bug fixes </a>
</h2>
<ul>

<li>Fixed "Restore Defaults" when actors and directors
use the three argument constructor for parameters.

<li>Previously, if a class definition were to show the name
of ports, there was no way to turn this off (the attribute
_showName) could not be removed. Now, marker attributes
such as _showName are boolean valued parameters, so they
can be turned off by overriding their value.

<li>Fixed long standing bug in copy where objects are represented
in the wrong order in the exported MoML.

<li>Fixed some subtle bugs in ModalModel, where changes to
input/output status and ordering of ports were not properly
reflected in the mirror ports.

<li> A number of potential deadlocks have been fixed:
<ul>
 <li> deadlock while dragging actors during a run.
 <li> deadlocks in PN when exceptions occur in the model.
</ul>

</ul>

</ul>


<h2>Backward Compatibility</h2>


Most models developed under Ptolemy II 1.0.1,
2.0.1, 3.0.2, 4.01  or HyVisual 2.2-beta an Hyvisual 3.0
should run under Ptolemy II 5.0

The MoMLParser includes a list of backward
compatibility filters that make certain changes on models
when read, handling such issues as actors being moved or renamed
and parameter names being changed.
The filters themselves are defined in
<a href="codeDoc/ptolemy/moml/filter/package-summary.html">
ptolemy.moml.filter</a>.
If you have developed your own actors under earlier versions of Ptolemy II by
writing your own Java files, you should recompile all your java code with
the new release.  In theory, copying the .class files should work, but
recompiling is safer.


<h3>Backward compatible issues that are handled automatically</h3>

<ul>
<li>ptolemy.moml.filter.AddEditorFactory: If a parameter has a _location, then
add a VisibleParameterEditorFactory named _editorFactory.

<li>ptolemy.moml.filter.AddIcon: Add specialized icons that display the value
of one of the parameters.
<br>The affected actors are:
	<ul>
	<li>ptolemy.actor.lib.Const
	<li>ptolemy.actor.lib.MathFunction
	<li>ptolemy.actor.lib.TrigFunction
	<li>ptolemy.actor.lib.Scale
	<li>ptolemy.actor.lib.Expression
        </ul>

<li>ptolemy.moml.filter.ClassChanges: change any class names that have been renamed and remove obsolete classes.
Below are original class names followed by the new class names:
	<ul>
	<li>ptolemy.vergil.fsm.modal.ModalController	 -&gt; ptolemy.domains.fsm.modal.ModalController
	<li>ptolemy.vergil.fsm.modal.ModalModel$ModalTableauFactory	 -&gt; ptolemy.vergil.fsm.modal.ModalTableauFactory
	<li>ptolemy.vergil.fsm.modal.TransitionRefinement	 -&gt; ptolemy.domains.fsm.modal.TransitionRefinement
	<li>ptolemy.vergil.fsm.modal.RefinementPort	 -&gt; ptolemy.domains.fsm.modal.RefinementPort
	<li>ptolemy.vergil.fsm.modal.Refinement	 -&gt; ptolemy.domains.fsm.modal.Refinement
	<li>ptolemy.kernel.util.VersionAttribute	 -&gt; ptolemy.kernel.attributes.VersionAttribute
	<li>ptolemy.vergil.icon.ImageEditorIcon	 -&gt; ptolemy.vergil.icon.ImageIcon
	<li>ptolemy.domains.fsm.kernel.InterfaceAutomatonTransition	 -&gt; ptolemy.domains.fsm.kernel.ia.InterfaceAutomatonTransition
	<li>ptolemy.vergil.fsm.modal.ModalPort	 -&gt; ptolemy.domains.fsm.modal.ModalPort
	<li>ptolemy.kernel.attributes.IDAttribute	 -&gt; ptolemy.vergil.kernel.attributes.IDAttribute
	<li>ptolemy.vergil.fsm.modal.TransitionRefinementPort	 -&gt; ptolemy.domains.fsm.modal.TransitionRefinementPort
	<li>ptolemy.kernel.attributes.FileAttribute	 -&gt; ptolemy.data.expr.FileParameter
	<li>ptolemy.domains.sr.lib.Latch	 -&gt; ptolemy.domains.sr.lib.Current
	<li>ptolemy.domains.sdf.kernel.SDFIOPort	 -&gt; ptolemy.actor.TypedIOPort
	<li>ptolemy.moml.Location	 -&gt; ptolemy.kernel.util.Location
	<li>ptolemy.domains.fsm.lib.RelationList	 -&gt; ptolemy.domains.fsm.kernel.RelationList
	<li>ptolemy.domains.gr.lib.ViewScreen	 -&gt; ptolemy.domains.gr.lib.ViewScreen3D
	<li>ptolemy.actor.lib.comm.SerialComm	 -&gt; ptolemy.actor.lib.io.comm.SerialComm
	<li>ptolemy.actor.hoc.MultiInstanceComposite	 -&gt; ptolemy.actor.lib.hoc.MultiInstanceComposite
	<li>ptolemy.vergil.fsm.modal.ModalModel	 -&gt; ptolemy.domains.fsm.modal.ModalModel
        <ul>
Below are the classes to remove:
	<ul>
	<li>ptolemy.data.expr.NotEditableParameter
	<li>ptolemy.domains.de.kernel.DEIOPort
	<ul>

<li>ptolemy.moml.filter.HideAnnotationNames: If an annotation name ends with
'annotation1', then add _hideName if necessary.

<li>ptolemy.moml.filter.MultiportToSinglePort: Update any actor multiports that are now
single ports.
<br>Below are the actors that are affected, along with the port name:
	<ul>
	<li>ptolemy.actor.lib.gui.MatrixViewer
	<li>input	ptolemy.domains.sdf.lib.Autocorrelation
	<li>output	ptolemy.actor.lib.Const
	<li>output	ptolemy.actor.lib.NonStrictTest
	<li>input
	</ul>

<li>ptolemy.moml.filter.ParameterNameChanges: Update any Parameter names
that have been renamed.
<br>Below are the actors that are affected, along with the Parameter name 
and the new name:
	<ul>
	<li>ptolemy.domains.de.lib.Server
		serviceTime	 -&gt; newServiceTime
	<li>ptolemy.domains.pn.kernel.PNDirector
		Initial_queue_capacity	 -&gt; initialQueueCapacity
	<li>ptolemy.domains.de.lib.VariableDelay
		defaultDelay	 -&gt; delay
	<ul>
<li>ptolemy.moml.filter.PortClassChanges: Update any actor port classes that have been
changed.
<br>Below are the actors that are affected, along
with the old port class and the new port class:
	<ul>
	<li>ptolemy.domains.sdf.lib.vq.HTVQEncode.input
		<ul>
	<li>	ptolemy.domains.sdf.kernel.SDFIOPort	 -&gt; ptolemy.actor.TypedIOPort
		</ul>
	<li>output
		<ul>
	<li>	ptolemy.domains.sdf.kernel.SDFIOPort	 -&gt; ptolemy.actor.TypedIOPort
		</ul>
	<li>ptolemy.domains.de.lib.Server.newServiceTime
		<ul>
	<li>	ptolemy.domains.de.kernel.DEIOPort	 -&gt; ptolemy.actor.parameters.ParameterPort
		</ul>
	<li>ptolemy.domains.sdf.lib.vq.VQDecode.input
		<ul>
	<li>	ptolemy.domains.sdf.kernel.SDFIOPort	 -&gt; ptolemy.actor.TypedIOPort
		</ul>
	<li>output
		<ul>
	<li>	ptolemy.domains.sdf.kernel.SDFIOPort	 -&gt; ptolemy.actor.TypedIOPort
		</ul>
	<li>ptolemy.domains.sdf.lib.vq.ImagePartition.input
		<ul>
	<li>	ptolemy.domains.sdf.kernel.SDFIOPort	 -&gt; ptolemy.actor.TypedIOPort
		</ul>
	<li>output
		<ul>
	<li>	ptolemy.domains.sdf.kernel.SDFIOPort	 -&gt; ptolemy.actor.TypedIOPort
		</ul>
	<li>ptolemy.domains.de.lib.VariableDelay.delay
		<ul>
		ptolemy.domains.de.kernel.DEIOPort	 -&gt; ptolemy.actor.parameters.ParameterPort
		</ul>
	<li>ptolemy.domains.sdf.lib.vq.ImageUnpartition.input
		<ul>
	<li>	ptolemy.domains.sdf.kernel.SDFIOPort	 -&gt; ptolemy.actor.TypedIOPort
		</ul>
	<li>output
		<ul>
		<li>ptolemy.domains.sdf.kernel.SDFIOPort	 -&gt; ptolemy.actor.TypedIOPort
		</ul>
        </ul>

<li>ptolemy.moml.filter.PortNameChanges: Update any actor port names that have been
renamed.
<br>Below are the actors that are affected, along
with the old port name and the new port name:
	<ul>
	<li>ptolemy.domains.de.lib.Server
		serviceTime	 -&gt; newServiceTime
	<li>ptolemy.actor.lib.comm.Scrambler
		initial	 -&gt; initialState
	<li>ptolemy.actor.lib.conversions.CartesianToComplex
		imag	 -&gt; y
		real	 -&gt; x
	<li>ptolemy.actor.lib.comm.ConvolutionalCoder
		uncodeBlockSize	 -&gt; uncodedRate
		initial	 -&gt; initialState
	<li>ptolemy.actor.lib.comm.ViterbiDecoder
		uncodeBlockSize	 -&gt; uncodedRate
		amplitude	 -&gt; constellation
	<li>ptolemy.actor.lib.Sleep
		delay	 -&gt; sleepTime
	<li>ptolemy.actor.lib.conversions.ComplexToCartesian
		imag	 -&gt; y
		real	 -&gt; x
        </ul>

<li>ptolemy.moml.filter.PropertyClassChanges: Update any actor port class names
that have been renamed.
<br>Below are the actors that are affected, along with the port name
and the new classname:
	<ul>
	<li>ptolemy.domains.ct.lib.ZeroCrossingDetector
		useEventValue	 -&gt; null
	<li>ptolemy.actor.lib.MathFunction
		function	 -&gt; ptolemy.data.expr.StringParameter
	<li>ptolemy.domains.ct.lib.LevelCrossingDetector
		useEventValue	 -&gt; null
	<li>ptolemy.domains.ct.kernel.CTEmbeddedDirector
		breakpointODESolver	 -&gt; null
	<li>ptolemy.domains.sdf.lib.Autocorrelation
	<li>ptolemy.domains.sdf.lib.FIR
	<li>ptolemy.domains.sdf.lib.Chop
	<li>ptolemy.domains.sdf.lib.BitsToInt
	<li>ptolemy.domains.sdf.lib.DownSample
	<li>ptolemy.domains.sdf.lib.DoubleToMatrix
	<li>ptolemy.domains.sdf.lib.IntToBits
	<li>ptolemy.domains.sdf.lib.ArrayToSequence
	<li>ptolemy.domains.sdf.lib.CountTrues
	<li>ptolemy.domains.sdf.lib.VariableFIR
	<li>ptolemy.domains.sdf.lib.MatrixToSequence
	<li>ptolemy.domains.sdf.lib.IFFT
	<li>ptolemy.domains.sdf.lib.SequenceToArray
	<li>ptolemy.domains.sdf.lib.FFT
	<li>ptolemy.domains.sdf.lib.SampleDelay
	<li>ptolemy.domains.sdf.lib.MatrixToDouble
	<li>ptolemy.domains.sdf.lib.LineCoder
	<li>ptolemy.domains.sdf.lib.SequenceToMatrix
	<li>ptolemy.domains.sdf.lib.Repeat
	<li>ptolemy.domains.sdf.lib.UpSample
		tokenProductionRate	 -&gt; null
		tokenInitProduction	 -&gt; null
		tokenConsumptionRate	 -&gt; null
	<li>ptolemy.kernel.util.Attribute
		_hideName	 -&gt; ptolemy.kernel.util.SingletonAttribute
	<li>ptolemy.domains.sr.kernel.Director
		scheduler	 -&gt; ptolemy.data.expr.StringParameter
	<li>ptolemy.actor.lib.io.DirectoryListing
		directoryOrURL	 -&gt; ptolemy.actor.parameters.FilePortParameter
	<li>ptolemy.actor.lib.TrigFunction
		function	 -&gt; ptolemy.data.expr.StringParameter
	<li>ptolemy.vergil.actor.lib.VisualModelReference
		modelFileOrURL	 -&gt; ptolemy.actor.parameters.FilePortParameter
	<li>ptolemy.actor.lib.Expression
		expression	 -&gt; ptolemy.kernel.util.StringAttribute
	<li>ptolemy.domains.ct.kernel.CTMixedSignalDirector
		breakpointODESolver	 -&gt; null
	<li>ptolemy.actor.lib.hoc.ModelReference
		modelFileOrURL	 -&gt; ptolemy.actor.parameters.FilePortParameter
	<li>ptolemy.matlab.Expression
		expression	 -&gt; ptolemy.data.expr.StringParameter
	<li>ptolemy.domains.fsm.modal.ModalModel
		_Director	 -&gt; null
		directorClass	 -&gt; ptolemy.data.expr.StringParameter
	<li>ptolemy.domains.ct.kernel.CTMultiSolverDirector
		breakpointODESolver	 -&gt; null
	</ul>
<li>ptolemy.moml.filter.GRColorChanges: Update GR actor with the following changes:
	Parameter name "RGB color" --&gt; "diffuseColor"

<li>ptolemy.moml.filter.RemoveProperties: Remove the properties listed below:
        <ul>
	<li>stopTime
		<ul>
	<li>	MaxDouble	 -&gt; null
	<li>	ptolemy.data.expr.Parameter	 -&gt; null
	<li>	1.7976931348623157E308	 -&gt; null
	<li>	1.7976931348623E308	 -&gt; null
	<li>	1.797693134862316E308	 -&gt; null
		</ul>
	<li>directorClass
		<ul>
	<li>	ptolemy.data.expr.StringParameter	 -&gt; null
	<li>	ptolemy.domains.fsm.kernel.HSDirector	 -&gt; null
	<li>	ptolemy.kernel.util.StringAttribute	 -&gt; null
		</ul>
        </ul>	

</ul>

<!--/whatsnew-->

<h2>Features that were new in previous Ptolemy II releases </h2>

<a href="oldFeatures.htm">Features that were new in previous Ptolemy II releases </a>


<!--vergilDocs-->
<h2><a name="limitations">Limitations</a>
</h2>
Version 5.0 has the following limitations:

<h3>Release Limitations</h3>
<ul>

<li> The gzipped tar file that contains the Ptolemy II distribution
 <B>requires</B> GNU tar or WinZip.  Solaris 2.5.1 tar will fail to
untar this file with a checksum error because the pathnames are longer
than 100 characters.  If you do not have GNU tar, you can obtain
source and selected binaries from 
ftp://ptolemy.eecs.berkeley.edu/pub/gnu.
 <p>Note further that some of the .class names are longer than
31 characters, which may cause problems when downloading zip files
on the Macintosh and using Stuffit.

<li> The documentation for custom actors used in demonstrations is not
included in the release.  The source code for the custom actors can be found
in the source download.

<li> If a URL ends with <CODE>#in_browser</CODE>, then
Ptolemy II will invoke the User's web browser.  Unfortunately, this
does not always work, especially under Windows if Netscape is already
running.  The workaround is to exit Netscape and let Ptolemy II
start up Netscape for you.


<li> Web Start does not work very well if the pathname to the 
<CODE>vergil.jnlp</CODE> file has spaces in it.  The workaround is
to place your Ptolemy II tree in a directory that does not have spaces
in the path name if you plan on using Web Start.

<li> If your user library contains actors that are not present in
vergil, then you may see a dialog or dialogs asking if you want
to skip these elements.  This could happen if you had developed custom
actors and put them into your user library and these custom actors
are not present in the release.  The work around is to click 'Skip Element'
and continue with the start up.


<li> Applet issues:
	<ul>

	<li> We've experienced problems with the browser freezing
	when between applets.  What happens is that the previous
	applet gets a InterruptedException and pops up a modal dialog
	box, which freezed the browser.  We are working on a solution.

	<li> Applets do not correctly display the TextAttribute,
	DocumentationAttribute or the TM "Show schedule" icon.

	<li> The Ptolemy II Applets require java 1.4.1_02 or later so
	as to prevent problems with Windows XP and Radeon displays
	that causes XP to hang when a Java application is exiting.
	For details, see

<a href="http://developer.java.sun.com/developer/bugParade/bugs/4713003.html#in_browser" target="_top"><CODE>http://developer.java.sun.com/developer/bugParade/bugs/4713003.html</CODE></a>
	 <br>For non-applet situations, we can invoke the browser with
	<CODE>-Dsun.java2d.d3d=false</CODE> or 
	<CODE>-Dsun.java2d.noddraw=true</CODE>, but for applets we must
	require Java 1.4.1_02 or later.  
	 <br>As a result, the applet html code requires version 1.4.2 or later,

	<li>Applets seem to run out of memory after about 82Mb.

	<li>There are no Jython or Cal applets 

	<li> Opera has problems viewing applets that are on the local
	file system.  In particular, it seems to have problems with urls like
	<CODE>file:///d|/ptII/ptolemy/plot/demo/FourierSeries.htm</CODE>
	which work fine in Netscape 4.x, IE, Mozilla.

	 <p>However, if I use the following style of URL, then some of the applets
	work: 
<CODE>file://localhost/d:/ptII/ptolemy/plot/demo/FourierSeries.htm</CODE>.
	Unfortunately any applet that accesses a data file will
	not work with the above URL style because the data file will
	be outside the codebase.

	 <p> The solution is to install a web server on the local
	machine and view the applets using 
	<CODE>http://localhost/</CODE>
	
        <li> Opera 6.03/Windows 2000/Java 1.4.0, may have
        problems running applets that include diva.jar if diva.jar
	is not downloaded in the first applet.  To reproduce this problem:
	<ol>
	<li> Run <a href="../ptolemy/domains/sdf/demo/Butterfly/Butterfly.htm">SDF Butterfly</a>, which does not use diva.jar

	<li> <a href="../ptolemy/domains/sdf/demo/Expression/Expression.htm">SDF Expression</a>, which uses diva.jar

	<li> In Opera, do <CODE>Window</CODE> -&gt; <CODE>Special</CODE>
	-&gt; <CODE>Java Console</CODE>, and you will see the following
        stack trace
<pre>
java.lang.NoClassDefFoundError: diva/graph/GraphController	
at java.lang.Class.getDeclaredConstructors0(Native Method)  
at java.lang.Class.privateGetDeclaredConstructors(Class.java:1576) 
at java.lang.Class.getConstructor0(Class.java:1748) 
at java.lang.Class.newInstance0(Class.java:266)  
at java.lang.Class.newInstance(Class.java:249) 
at opera.PluginPanel.run(opera/PluginPanel.java:343) 
at java.lang.Thread.run(Thread.java:536)  
</pre>

	</ol>
	The problem only occurs under Opera.

	<li> Running the Networked demo via an applet on the local
	file system results in an AccessControlException.
<pre>
com.microstar.htm.htmException: XML element "entity" triggers exception:
  java.lang.Exception: Attempted to lookup 'Waveform', but got: 
  java.lang.ClassNotFoundException: Waveform
Attempted to find as a moml class, but got: 
             java.security.AccessControlException: access denied
             (java.net.SocketPermission ptolemy.eecs.berkeley.edu resolve)
	     in file:/C:/Program Files/Ptolemy/Ptolemy II 3.0 beta2/
                   ptolemy/moml/demo/Networked/ at line 62 and column 118
	at ptolemy.moml.MoMLParser.startElement(MoMLParser.java:1341)
	at com.microstar.htm.htmParser.parseElement(XmlParser.java:944)
	at com.microstar.htm.htmParser.parseContent(XmlParser.java:1117)
	at com.microstar.htm.htmParser.parseElement(XmlParser.java:946)
	at com.microstar.htm.htmParser.parseDocument(XmlParser.java:495)
	at com.microstar.htm.htmParser.doParse(XmlParser.java:175)
	at com.microstar.htm.htmParser.parse(XmlParser.java:145)
	at ptolemy.moml.MoMLParser.parse(MoMLParser.java:492)
	at ptolemy.moml.MoMLParser.parse(MoMLParser.java:471)
	at ptolemy.moml.MoMLParser.parse(MoMLParser.java:456)
	at ptolemy.actor.gui.MoMLApplet._createModel(MoMLApplet.java:188)
</pre>

	The Network demo does not work as a local applet because the xml file
	includes a reference to http://ptolemy.eecs.berkeley.edu, which is
	not on the local file system, so we get a SecurityException.
	 <br>The workaround is to run the applet by downloading it
	from the Ptolemy Website:
<a href="http://ptolemy.eecs.berkeley.edu/ptolemyII/ptII5.0/ptII/ptolemy/moml/demo/Networked/Networked.htm"><CODE>http://ptolemy.eecs.berkeley.edu/ptolemyII/ptII5.0/ptII/ptolemy/moml/demo/Networked/Networked.htm</CODE></a>


	<li> If an icon file is not present, then a Vergil applet might
	try to download the icon file multiple times.  Ptolemy II
	uses XML files to store icons.  For example
<a href="../ptolemy/actor/lib/BooleanSwitchIcon.xml"><CODE>$PTII/ptolemy/actor/lib/BooleanSwitchIcon.xml</CODE></a>
	is an icon for
<a href="../ptolemy/actor/lib/BooleanSwitch.java"><CODE>$PTII/ptolemy/actor/lib/BooleanSwitch.java</CODE></a>
	 <br>The problem is that if an actor does not have an icon file,
	then the applet may go back to the server multiple times looking
	for the icon. 
 <!-- Steve writes:
      I think the MoMLParser should load Java-defined classes the same way
      it does xml-defined classes.  It should reflect a prototype and then
      keep the prototype around and clone it...  This would mean that it
      only has to grab the icon once...
 -->

	</ul>

<li> Windows Installer Issues:
 	<ul>

	<li> Sometimes running a model that uses the Matlab interface
	will cause Ptolemy II to exit.  Usually this occurs if Vergil
	has been running for a while and then the Matlab interface is loaded.
	<br><b>Workaround #1</b>: Run a model that uses the Matlab interface
	as the first model by doing Quick Tour -&gt; Matlab CT.
	<br><b>Workaround #2</b>:
        We believe that the problem has to do with loading the Direct
	Draw library.
<a href="http://developer.java.sun.com/developer/bugParade/bugs/4838939.html#in_browser" target="_top"><code>http://developer.java.sun.com/developer/bugParade/bugs/4838939.html</code></a>
        suggests invoking java with <code>-Dsun.java2d.noddraw=true</code>.
	<br>The way to do this is to edit <code>vergil-full.<b>lax</b></code>
	and add the line
	<pre>
lax.nl.java.option.additional=-Dsun.java2d.noddraw=true	
</pre>
        which we went ahead and did.  Note that because of problems
	with Radeon displays, setting noddraw to true is not such
	a bad idea.  See above for details.
        <br>The way to check if this argument is being used is to
	hold down the Control key and double click on the
	<code>vergil-full.<b>exe</b></code> icon.
	<br>You should see something like:
	<pre>	
c:\j2sdk1.4.2\bin\java.exe -Dsun.java2d.noddraw=true com.zerog.lax.LAX C:\\Ptol
emy\\Ptolemy_II_5.0ptiny\\vergil-ptiny.lax C:\\DOCUME~1\\cxh\\LOCALS~1\\Temp
\\env.prop
executing java...
        </pre>
	Note that to debug the binary, you would use the following line:
        <pre>
lax.nl.java.option.additional=-Xdebug -Xrunjdwp:transport=dt_shmem,server=y,suspend=n 
        </pre>

	<li> The Windows installer works best if you are in the 
	Administrators Windows group.   Otherwise, the Windows installer
	tends to dump lots of icons on your desktop
	</ul>

<li> Web Start issues:
	<ul>

	<li> The Matlab Wireless demo fails under Web Start.
	The problem is that the Matlab .m file cannot be found.

	<li> The Python Ptolemizer demo does not work under Web Start,
	probably because Jython cannot handle loading classes
	from the Ptolemy II classes. 


        <li> The JAI Adaptive Median model does not work under
	Web Start - the repaired image might be corrupt.
	The reason is that it uses the JAI acceleration libraries,
	which Web Start does not load.  

	<li> Viewing a pdf file may bring up a blank window along with
	the pdf file.  Running the code generator may bring up
	a blank window while the java or javac processes are running.

	<li> Some of the links on the GR domain instructions page
	might not work under Web Start because the files they refer
	to are not present. 
        </ul>

<li> Limitations in demonstrations
        <ul>

	<li> CT CarTracking should be run using View-&gt;Run
	so that the user can change the fault parameter.

        <li> HTVQ demo: The displays do not go away when
	the demo is exited.

	<li> GR demos: Under Java 3D 1.3.1-beta, the ViewScreen
	actor may display a black image when a second GR demo is run.
	 <br>The workaround is to install Java 3D 1.2.1_04.

        <li> Bouncer demo: If the user drags the bouncing icon, it no
	longer bounces
        </ul>
</ul>
<h3>Limitations in the Class Mechanism</h3>
The class mechanism is highly preliminary and is likely to change
in future releases.  There are several known problems:

<ul>


<li> Several higher-order-components will not work inside class definitions.
    (ModalModel, several CT actors, etc.).


<li> Name collisions can occur when adding objects to base classes
    whose names collide with objects in derived classes.
    Auto naming should look through the derivedList for name conflicts.


<li> Propagation of changes to a base class is very slow in Vergil.
    If there are more than just a very few instances or derived
    classes, interactive editing is not practical.  As a workaround,
    put the class definitions in a separate file and edit them
    without opening the model that creates instances. The probable
    reason is that MoMLParser handles propagation by issuing large
    numbers of change requests.


<li> Certain actors, such as MathFunction, change the number of ports
    when parameters change.  This violates the derivation invariance
    for classes.  To demonstrate the bug, put a MathFunction actor
    in a base class that has a subclass.  Change the function parameter
    in the subclass to anything but "modulo".  Then change the function
    in the base class to "modulo" (which adds a port).  Now attempt
    to insert a parameter into the port.  You will get an
    InternalErrorException when it tries to propagate the change.
</ul>


<h3>Limitations in the Actor Libraries</h3>
<ul>
<li>The actor library is far from complete.

<li>The Expression actor does not properly propagate type constraints in
an expression-dependent fashion. It works correctly for double-valued
expressions of double-valued inputs.

<li> The Ptolemy parameter parser uses comma "," to separate elements
in an array.  This causes problems when Ptolemy is run on
European machines that use a comma "1,0" instead of a period "1.1"
in floating point numbers.

<li> The Display actor uses the Swing JTextArea component which is 
known to have memory leaks.

<li> The readFile() parameter function does not work with applets.
Instead, use readResource().
<!-- If you change the next paragraph update install.htm -->

<li>The Matlab interface works only under Windows and it requires that
Matlab be installed on the local machine. 
The Matlab interface should work with version of Matlab from
R11 (5.3) and up to and including R13 (6.5)
<p>Didier Mauuary reports that under Windows 98, configure failed
to set up the <code>MATLAB_DIR</code>, <code>PTCC</code>
and <code>PTDLLTOOL</code> makefile variables, but after
he set them by hand:
<pre>
 MATLAB_DIR = /cygdrive/c/MATLABR11
 PTCC = gcc
 PTDLLTOOL = dlltool
</pre>
he was able to get farther with the recompilation of the Matlab interface.

<li>Under Windows, the Matlab interface has problems at runtime with gcc-3.3.
<br>Under Windows, we recommend using gcc-3.2, or Microsoft Visual C.

<li>Under Windows, Matlab models sometimes cause Ptolemy to exit the
second time the model is run!
<br>The problem seems to be a segfault within a Windows library.
The problem only affects systems where Matlab is compiled with 
Microsoft Visual C.


<li> The actor.lib.comm.SerialComm actor requires that Javacomm is installed

<a href="http://java.sun.com/products/javacomm/index.html#in_browser" target="_top"><CODE>http://java.sun.com/products/javacomm/index.html</CODE></a>.
The SerialComm actor will only work under Windows.


<li> IterateOverArray has the following problems
     <menu>

	<li> IterateOverArray: When you drop in an actor, and then
	another actor, and then select "undo," the second actor is
	deleted without the first one being re-created. Thus, undo is
        only a partial undo. The fix to this is extremely
        complicated. Probably the only viable
        mechanism is to use UndoStackAttribute.getUndoInfo() to get the undo
        stack and then to manipulate the contents of that stack directly.
	
	<li> IterateOverArray: There should be an option to reset
	between firings of the inside actor.


	<li> IterateOverArray: If you drop a new actor onto an IterateOverArray
        in a subclass, it will simply acquire the new contents, but not
        actually do anything with them. It should somehow refuse to accept
        the new object in the subclass, since to do so, it would have to
        delete the original object defined in the base class, and this would
        violate the derived invariant.

        
	<li> IterateOverArray: If an instance of IterateOverArray in a derived
        class has overridden values of parameters, those are lost if
        contained entity of the instance in the base class is replaced and
        then an undo is requested.

       
        <li> IterateOverArray: When an actor with a display icon like
        Const, Expression, or MathFunction is put into
        IterateOverArray, the CopyCatIcon doesn't reflect the text display.

     </menu>

</ul>

<h3>Limitations in the PN Domain</h3>
The PN domain documents that it locally handles mutations.  However, this
is currently not true in the implementation.  For the basic PN model, this
doesn't really matter, since mutations happen pretty much the same as they
would otherwise.  (i.e. they are non-deterministic in when they execute) 
However, for timed PN models, there is actually some expressiveness
lost, since timed PN models can locally execute mutations deterministically.

 <p>Embedding a PN typed composite actor inside a non-process top level
such as DE does not work.  In fact embedding a process domain inside
a non-process domain is likely to have problems.  Profess Lee wrote:
<BLOCKQUOTE>
    Yes, it looks as if the code is designed so that process domains
    (PN, CSP) can only be used within process domains.  I'm not sure
    to what extent this is a limitation of the process domains vs. a
    semantic problem.  What would PN mean within DE?  Since PN has
    no well-defined notion of a "firing", how would you assign time
    stamps to the outputs of a PN actor?  By default in DE, the time
    stamps of the outputs of an actor match those of the inputs that
    triggered the firing. There is no such notion in PN.
</BLOCKQUOTE>

<h3>Limitations in the User Interface</h3>

Below are some of the limitations of Vergil, the Ptolemy II Graphical
User Interface.

<ul>

<li> The labeling of ports gets messed up if you change cardinality.


<li> Cancelling a style change doesn't restore original
state.  There are FIXME's about this in actor.gui.style.StyleConfigurer.

<li> If there are multiple windows open for a model, say, the top
level vergil window and the tree view, or the top level window
and the inside look of a composite component, when the top
level window is closed, all other windows are closed, but the
user is not prompted to save any change to the model.

<li> When setting the type of a port, we should provide a combo
box that lists the common ports

<li> When creating a Modal Model, use Control-Right-Button to
drawn arcs between nodes.  One potential workaround would
be to have an information message in the status bar about this.

<li> You should not change the names of built in ports - The port
mechanism should disallow port name changes on ports that are
named in Java.  The UI could recognize this.  The UI should
not allow the user to remove built in Java defined ports.

<li> Manually setting of the types of actors like ArrayToSequence that
have constraints on their element types can cause problems.
<li> HTVQ demo is badly laid out when run under vergil.
<li>Weak support for multiports in the graph editor.
<li>It is difficult to control wire routing.
<li>Cannot have more than one vertex in a connection.
<li>No mechanism to set the width of a relation.
<li>The integrated web browser is not a full-featured browser.
<li>Debugger not yet integrated.
<li>It is difficult to add actors to the libraries.
<li>No dynamic class reloading.


<li> Plot windows don't resize when control panel is resized
 <br>If a model with plotters
is executed using the run button on the toolbar, and
then re-executed using the run control panel accessed through
the View menu, then resizing the run control panel does not
cause the plots to resize to fit.
<br>Workaround:
Close the model and re-open it, and then run first using the
run control panel.

<li>There is no mechanism in the UI to save a model as a class,
nor to save a submodel as a class.

<li>There is no mechanism in the UI to create a custom icon for
a library element and store it in the right place.

<li>If an actor uses a slider, then the actor tree navigator pane
incorrectly shows the slider as a subitem of the actor.

<li> It seems that if you close a model that has been modified,
  get prompted to save it, and select save, then the model
  is saved but not closed.  It should be closed too...

<li> When I select a large number of items from one model, and
  copy and paste them into a new one, they sometimes all get
  placed at the origin.  Strangely, if I then auto-place,
  and then undo, they get their original (correct) placement!


<li> Printing a model that contains transparent objects can result
in problems when printing to Encapsulated Postscript (EPS).

 <br>If a model has transparent objects, then when it is printed to
EPS, the resulting file is a bitmap instead of a Postscript
description of the graphics.  You can tell by the file size (several
Meg vs. several K) and by opening it in Illustrator, where in theory
you should be able to ungroup and select and edit individual
components.

 <br>The way Java prints EPS is that there is an implementation of
Graphics2D that literally translates each graphics2D call into a
Postscript snippet.  If Java detects any transparent colors or images,
then the literal translation of each element independently doesn't
work, so the printing code reverts to writing everything to an image
and then sending the image, encapsulated in Postscript to the printer.

 <br>Solution1: Use one of these pdf writing programs to generate
pdf-1.4 compliant pdf files, which have extensions to support
transparency that Postscript lacks, and then print them to eps, which
would use the distill implementation of the above algorithm.
Or alternatively, we could switch to using pdftex instead of 
latex-&gt;dvips-&gt;distill which should
embed pdf for figures directly at the expense of less robust latex support.
<a href="http://www.geocities.com/marcoschmidt.geo/java-libraries-pdf.html#in_browser" target="_top"><CODE>http://www.geocities.com/marcoschmidt.geo/java-libraries-pdf.html</CODE></a>

 <br>Solution 2: Use the undocumented flag
-Dsun.java2d.print.pipeline=pdl on the command line to force the
printing to use the postscript path, ignoring transparency.
Under Cygwin:
<pre>
export JAVAFLAGS=-Dsun.java2d.print.pipeline=pdl
vergil
</pre>
Then edit the file by hand in Illustrator to add the transparency back in.

</ul>

<h3>Limitations in JNI</h3>
<menu>
<li> The Interface to C actors using the Java Native Interface
	is not available via the Windows Installer (or Web Start).
	To use the JNI/Ptolemy II interface, you must download 
	Ptolemy II as source files and compile.


<li> The JNI user interface was removed between Ptolemy II 4.0
and Ptolemy II 5.0 because the UI stopped working.

</menu>


<h3>Code Generation Limitations</h3>
Code Generation limitations are covered on the
<a href="codegen.htm#limitations">Code Generation</a> page. 

<h3>Missing Domains</h3>
<ul>
<li>Boolean and integer dataflow.
</ul>
 <p>For limitations discovered after the release, see the
<a href="http://ptolemy.eecs.berkeley.edu/ptolemyII/ptII5.0/#in_browser">Ptolemy II 5.0 website</a>

<!--/vergilDocs-->
<p><font size="2" color="#cc0000">Last Updated: $Date$</font>
 <!-- Leave a trailing p here so that there is a little space at the bottom -->
 <p>
</body>
</html>
